<!DOCTYPE html><html lang="ko-KR" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="⛏️ Assembly" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="https://coding-factory.tistory.com/651 https://blog.naver.com/PostView.nhn?isHttpsRedirect=true&amp;blogId=ndb796&amp;logNo=221054682271 http://yuchi.duckdns.org/xe/Programming_QA/5934 http://yuchi.duckdns.org/xe/Programming_QA/5950 https://sunrinjuntae.tistory.com/24 https://araikuma.tistory.com/600 https://nan491.tistory.com/entry/%EC%8A%A4%ED%83%9DStack-PUSH-POP https://wikidocs.net/145932" /><meta property="og:description" content="https://coding-factory.tistory.com/651 https://blog.naver.com/PostView.nhn?isHttpsRedirect=true&amp;blogId=ndb796&amp;logNo=221054682271 http://yuchi.duckdns.org/xe/Programming_QA/5934 http://yuchi.duckdns.org/xe/Programming_QA/5950 https://sunrinjuntae.tistory.com/24 https://araikuma.tistory.com/600 https://nan491.tistory.com/entry/%EC%8A%A4%ED%83%9DStack-PUSH-POP https://wikidocs.net/145932" /><link rel="canonical" href="https://mascari4615.github.io/posts/Assembly/" /><meta property="og:url" content="https://mascari4615.github.io/posts/Assembly/" /><meta property="og:site_name" content="카모뜨린 아지트" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-04-06T11:16:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="⛏️ Assembly" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"https://coding-factory.tistory.com/651 https://blog.naver.com/PostView.nhn?isHttpsRedirect=true&amp;blogId=ndb796&amp;logNo=221054682271 http://yuchi.duckdns.org/xe/Programming_QA/5934 http://yuchi.duckdns.org/xe/Programming_QA/5950 https://sunrinjuntae.tistory.com/24 https://araikuma.tistory.com/600 https://nan491.tistory.com/entry/%EC%8A%A4%ED%83%9DStack-PUSH-POP https://wikidocs.net/145932","url":"https://mascari4615.github.io/posts/Assembly/","@type":"BlogPosting","headline":"⛏️ Assembly","dateModified":"2023-05-08T13:23:00+09:00","datePublished":"2023-04-06T11:16:00+09:00","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://mascari4615.github.io/assets/img/ProfileImage.png"}},"mainEntityOfPage":{"@type":"WebPage","@id":"https://mascari4615.github.io/posts/Assembly/"},"@context":"https://schema.org"}</script><meta name="twitter:card" content="summary"><meta name="twitter:title" content="카모뜨린 아지트}"><meta name="twitter:description" content="기록을 빙자한 일방적 독백"><meta name="twitter:image" content="https://mascari4615.github.io/assets/img/ProfileImage.png"><meta name="twitter:domain" content="카모뜨린 아지트"><title>⛏️ Assembly | 카모뜨린 아지트</title><meta property="og:type" content="website"><meta property="og:title" content="카모뜨린 아지트포기하면 거기서 깁업"><meta property="og:description" content="기록을 빙자한 일방적 독백"><meta property="og:image" content="https://mascari4615.github.io/assets/img/ProfileImage.png"><meta property="og:url" content="https://mascari4615.github.io/"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="카모뜨린 아지트"><meta name="application-name" content="카모뜨린 아지트"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://cdn.jsdelivr.net/gh/Mascari4615/Mascari4615.github.io@main/assets/img/ProfileImage.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">카모뜨린 아지트</a></div><div class="site-subtitle font-italic">포기하면 거기서 깁업</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Mascari4615" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>⛏️ Assembly</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>⛏️ Assembly</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Apr 6, 2023, 11:16 AM +0900" >Apr 6<i class="unloaded">2023-04-06T11:16:00+09:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, May 8, 2023, 1:23 PM +0900" >May 8<i class="unloaded">2023-05-08T13:23:00+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3977 words">22 min read</span></div></div><div class="post-content"><p><a href="https://coding-factory.tistory.com/651">https://coding-factory.tistory.com/651</a><br /> <a href="https://blog.naver.com/PostView.nhn?isHttpsRedirect=true&amp;blogId=ndb796&amp;logNo=221054682271">https://blog.naver.com/PostView.nhn?isHttpsRedirect=true&amp;blogId=ndb796&amp;logNo=221054682271</a><br /> <a href="http://yuchi.duckdns.org/xe/Programming_QA/5934">http://yuchi.duckdns.org/xe/Programming_QA/5934</a><br /> <a href="http://yuchi.duckdns.org/xe/Programming_QA/5950">http://yuchi.duckdns.org/xe/Programming_QA/5950</a><br /> <a href="https://sunrinjuntae.tistory.com/24">https://sunrinjuntae.tistory.com/24</a><br /> <a href="https://araikuma.tistory.com/600">https://araikuma.tistory.com/600</a><br /> <a href="https://nan491.tistory.com/entry/%EC%8A%A4%ED%83%9DStack-PUSH-POP">https://nan491.tistory.com/entry/%EC%8A%A4%ED%83%9DStack-PUSH-POP</a><br /> <a href="https://wikidocs.net/145932">https://wikidocs.net/145932</a></p><p>RAM, DRAM</p><p>ISA, Instruction Set Architecture, 프로그램 명령 구조<br /> ISA를 얼마나 Abstraction 추상화 했는지에 따라,<br /> → HLL High-Level Language<br /> → LLL Low-Level Language (= Machine L/기계어, Assemble L/Assembly)<br /> → 추상화 수준, Machine L &lt; Assembly &lt; HLL</p><p>Assembly 어셈블리<br /> Machine L 명령어와 1:1 대응되는 명령어 집합, Machine L ≈ Assembly<br /> → 둘 다 CPU에 직접 지시할 명령어의 집합을 만드는 것<br /> → 제약 사항, Machine L = Assembly</p><p>Assembly 주로, 가변인자 함수 직접 구현, HLL/HLL문법으로 할 수 없는 일, MMX/SSE 등 특수 기능</p><p>같은 명령어도 CPU/CPU 버전마다 기계어/Assembly가 다름<br /> I.E. Intel x86 계열 CPU 기계어/Assembly ≠ 다른 벤더 CPU<br /> (AMD/Cyrix CPU는 원래 Intel 호환칩, 모토롤라의 x68계열이 대표적인 비 호환칩)<br /> → 기계어/Assembly는 CPU 종속적, CPU가 달라지면 새 언어를 배워야..<br /> → High-Level 언어의 등장</p><p>Assembler, Assemble, Assembly → Machine L<br /> Compiler, Compile, HLL → Machine L, Assembly<br /> VM, HLL → VM(HW/SW Simulation), VM 설정 후 해당 VM용 Machine L로 Compile<br /> I.E. JAVA, PC에 띄워진 SW인 JVM으로 돌아감</p><p>UNIX OS가 C로 쓰인 이후, OS 거의 대부분 C<br /> 물론 HW 직접 다루거나, 속도에 민감한 일부는 Assembly로<br /> Windows, Unix, Linux도 대부분의 C + 일부 Assembly로</p><hr /><p>GUI vs CUI (Console)</p><p>Dos (Disk Operating System)<br /> IBM PC가 처음 보급될때 끼워판 OS<br /> Windows 98까지만해도 새까만 화면에 프롬프트 하나 뜨는 도스 부팅이 있었음<br /> Windows 2000/XP 이후 도스 부팅은 불가능<br /> OS 뜨고나면 Command Prompt창을 띄울 수 있는데, 엄연히 NT커널 아래 돌아가는 디자인만 도스창 같은 UI<br /> CUI 프로그램의 대표적인 예는 각종 온라인 게임의 서버 프로그램</p><hr /><ul><li>Preprocessor (전처리기)<ul><li>선행자 #, Like #include<li>Library, 기능 집합, *.lib (*.dll도 사용하지만 Compile 할 땐 *.lib)<li>Header File, Library 가져다 쓸 수 있게 선언해둔 것, *.h<li>#include, Header File 쓸 수 있게 하는 지시어</ul><li>Variable, 데이터를 담을 수 있는 일정 단위의 Register/Memory<li>Struct, 포함된 Variable(Data Type, Struct)들은 메모리 위에 연속적으로 존재<li>Array<ul><li>Struct 내의 필드(Variable)들의 사이즈는 불규칙<li>Array 한 칸의 사이즈는 모두 동일<li>숫자로 정확하게 찾아낼 수 있는 것이다. 인덱스 * 한칸 사이즈</ul><li>Pointer<ul><li>메모리의 주소를 다루는데 사용하는 데이터 타입<li>VS unsigned 정수형<ul><li><ol><li>컴파일러에 의해 타입 체크가 이루어짐</ol><li><ol><li>컴파일러에 의해 몇 가지 산술 연산 제한</ol><li><ol><li>++/–, 가리키는 데이터 타입 사이즈 만큼</ol></ul></ul><li>*.exe (pe File의 한 종류)<ul><li>pe Header에 main() Address의 상대번지가 Entry Point로 기록<li>*.exe가 로드되고 실행되면 이 주소를 읽어 main() 부터 실행</ul></ul><hr /><p>인자 Argument 전달<br /> 일반적으로 스택<br /> 32/64-bit 이하 데이터 블록은 스택에 push, 초과는 mov 등으로 카피하고 함수에 진입하여 스택 에서 pop하거나 mov 등으로 카피된 데이타를 억세스<br /> 큰 메모리 블럭을 바로 전달하려 하면 다 스택에 카피해야 하므로, 함수 진입시 속도 저하<br /> → Pointer, push 한번이면 되니까</p><p>지역변수, 함수를 벗어날때 소멸 (다른 코드들에 의해 Overwrite 가능)<br /> 함수 진입 시, 스택포인터(%SP) - 사이즈 (사용하는 지역변수의 총 사이즈를 계산해서 스택 공간 확보)<br /> 함수 리턴 시, SP 원래대로</p><p>Debug Interrupt<br /> CPU의 작동 흐름을 간섭하는 일종의 긴급 신호<br /> HW Interrupt, 타이머칩/타이머 Interrupt, 주변장치의 IO/HW Interrupt<br /> SW Interrupt, CPU가 연산도중 발생시키는 Interrupt<br /> /0, 금지된 메모리 영역을 Access -&gt; Interrupt 발생<br /> 게임 중 ‘잘못된 연산오류~’ 를 본다면 이와 같은 SW Interrupt로 인해 APP Crash<br /> SW Interrupt는 Exception, SW적으로 프로그래머가 발생시킬 수 있음, __asm int 3</p><p>버그 유형과 원인, 대처 요령<br /> 프로그램이 크래쉬하게 만드는 버그:</p><ul><li>commit 되지 않은 메모리 어드레스 억세스<ul><li>정상 OS하에 돌아가는 모든 SW는, OS로부터 메모리를 할당받아야만 쓸 수 있음<li>스택 영역도 프로세스 초기화시에 할당받은 영역<li>보통 reserve와 commit이라는 과정을 거쳐 메모리를 사용할 수 있게 되는데 commit이 이루어져야 할당받은 어드레스가 실제 물리 메모리에 맵핑된다.<li>만약 commit 되지 않은, 그러니까 물리 메모리에 맵핑 되지 않은 영역을 억세스 하려고 하면 CPU는 Exception 발생<li>또한 0번지는 사용이 불가하도록 OS가 설정해놓았으므로 commit/억세스 불가</ul><li>Heap Crash<ul><li>HEAP : 메모리를 미리 덩어리로 받아놓고 끊어쓰는 메모리 풀<li>I.E. malloc()/free(), new/delete<li>힙의 특성상 할당받은 사이즈를 넘겨서 덮어쓰게 되면 다른 블럭이 깨짐<li>Heap Crash가 발생하면 구현하기 나름이지만 눈치채지 못하게 조용하게 돌아갈수도 있고 APP Crash 할 수도, 파일이 열리지 않기도</ul></ul><hr /><pre><code class="language-Assembly">
; 레지스터
; CPU 안에 들어있는 고속 메모리, 데이터 이동, 산술 연산 등의 기능

; x86 CPU 기준
; 특수한 몇 개의 레지스터들을 제외하고는 모두 32비트 레지스터
; 16비트, 32비트는 선행자 E (32비트 386부터), 64비트는 선행자 R

; 범용 레지스터 AX, BX, CX, DX

; 8비트씩 쪼개서 사용 가능, 그냥 나눠 쓰기 위함도 있고, 과거 8086과 호환성 유지를 위해
; I.E. AX의 경우, AL (LOW바이트), AH (HI바이트), AL + AH = 16-bit AX, + 16-bit = 32-bit EAX, 32-bit = 64bit RAX, 
; X, E EXtended, R Register, [참고](https://stackoverflow.com/questions/43933379/what-do-the-e-and-r-prefixes-stand-for-in-the-names-of-intel-32-bit-and-64-bit-r)
; 네 개의 레지스터 모두 같은 규칙을 따른다, 보통 산술 연산에 많이 쓰이고, 몇 가지 특수한 기능

; AX, DX
; 곱셈 나눗셈을 할 때는 반드시 이 레지스터들을 사용해야
; 연산의 결과 혹은 소스의 값이 64비트일 때 하위 32비트 = EAX, 상위 32비트 = EDX에 저장된다.
; 인텔계 컴파일러에서는 함수의 리턴값이 eax레지스터를 통해 전달된다.

; BX
; 범용 레지스터 Default

; CX
; Counter, loop/movs 등의 명령과 함께 쓰일 경우 카운터로 쓰임

; 남은 4개의 레지스터는 주로 값을 저장하기 위해
; C와 굳이 비교하면 포인터 변수와 유사한 역할
; 그러나 주로 다른 값을 이미 저장하고 있기 때문에, 특수한 목적이 아니면 사용하지 않는 것이 좋다.
; 이와 같이 레지스터에 쓰임이 구분되어 있는 것을 보면 마치 저장해야 할 타입이 명시된 것처럼 보이나, 어셈블리의 레지스터는 32bit의 빈 공간에 불과하다.
; 즉, 메모리 주소 역시 하나의 정수 값에 지나지 않기에 레지스터에 저장한다.
; 따라서 %eax 같은 레지스터가 주소값 역시 저장할 수 있고, 실제로도 이렇게 활용하는 경우가 빈번하다.

; Stack Pointer, SP/ESP/RSP
; 현재 스택의 위치를 가리키는 레지스터
; 임의로 조작할 수도 있지만 일반적인 프로그램을 짤때는 건드리지 않는 것이 좋다.
; push, pop 명령과 연동된다. push하면 4바이트 감소, pop하면 4바이트 증가한다.
; 스택은 미리 일정 사이즈를 확보해놓고 그 상태에서 사용할때마다 0을 향해서 감소해가는 형태이기 때문에 push했을 때 스택포인터가 감소하는 것이다.
; 메모리 공간에서 Push==할당, pop==해제 라고 생각하면 된다.

; Base Pointer, BP/EBP/RBP
; 일반적으로 함수 진입 시에 스텍 프레임과 함수 안에서 자유롭게 사용하게 될(push, pop) 스택공간과의 경계를 지정하기 위해 사용한다.

; 물론 ebp를 사용하지 않고 바로 esp로 억세스 해도 되지만(실제로 컴파일러가 최적화할땐 그렇게 한다)
; 사람이 짤 때는 엄청나게 헷갈린다.
; 가령 함수에 진입했을 때 첫 번째 인자는 ebp+8의 메모리에 존재하지만 esp 기준으로는 어디가 될지 모른다.
; push, pop할때마다 esp의 값이 바뀌기 때문에 기준점으론 삼을 수가 없는 것이다.

; 인덱스 레지스터
; 인덱스 레지스터는 범용 레지스터들처럼 쪼개서 사용할 수 없다.
; 32비트 그 자체로만 사용할 수 있다.
; 데이터 이동에 관련된 특수한 명령들을 사용할 때 source와 destination 어드레스를 지정하는 등 주소지정에 관련된 특수 기능을 가지고 있기 때문에 인덱스 레지스터라고 한다.

; Source Index SI(16-bit)/ESI/RSI
; 왜 source인고 하니 특수한 데이터 이동 명령 movs 등을 사용할 때 esi에 source 메모리의 어드레스를 넣어야 하기 때문이다.
; 그 밖에는 일반적으로 메모리의 주소를 지칭할 때 이 레지스터를 사용한다.

; Destination DI(16-bit)/EDI/RDI
; ESI와 기본적으로 같고 movs등을 사용할 때 destination 어드레스를 넣어야 한다.

; ----

; Instruction Pointer IP 레지스터
; 프로그래머가 사용할 수 없는 레지스터, 다음으로 실행될 프로그램 명령행의 위치를 저장
; IP + 1, 연속적으로 실행해 명령행을 순차적으로 실행
; IP = n, 다른 위치로 한번에 이동해 if, while 과 같은 명령을 수행

; 디버그 레지스터, 플래그 래지스터 같은 특수한 레지스터들 유져모드 프로그래밍에선 쓸 일 

; MMX레지스터
; MMX레지스터는 펜티엄 클래식 MMX버전부터 추가되었다.
; 정확히는 물리적으로 존재하는 레지스터가 아니고 FPU 스택을 레지스터처럼 사용한다. MM0부터  MM7 까지 8개가 있다.

; SSE레지스터
; 펜티엄3부터 추가되었다.
; 32비트 float 데이타 4샘플을 동시에 처리할 수 있는 128비트 레지스터이다.
; XMM0부터 XMM7까지 8개가 있다.

; ----

; ALU Arithmetic And Logic Unit
; CPU 내의 실질적인 연산, 산술/논리 연산
; 연산 시 레지스터를 참조
; 연산 예외처리
; I.E. 오버플로우 Overflow, OF Overflow Flag 키기
; ZF Zero flag, OF Overflow Flag, CF Carry Flag, SF Sign Flag

; Bus
; 모든 컴퓨터 요소들을 연결시키는 길고 넓은 통로 (각각 연결시키면 비용이 크니까)
; 엮다 Omni'bus'

; Memory

; Kernel
; OS가 사용, 플머는 사용 금지/불가

; Stack
; Assembly가 빈번하게, 저장되는 값 저장, Subroutine, Procedure 등
; Stack 자료 구조
; BasePointer 시작 위치를 BP 레지스터, StackPointer 제일 위 위치를 SP 레지스터
; Glow Down, 다른 메모리 영역과 달리 거꾸로 자란다

; Heap
; 주로 메모리 동적 할당
; I.E. malloc, calloc, realloc

; DLLs
; Linker가 외부에서 가져온 코드를 합칠 때 사용

; Data
; 전역 변수 등이 저장

; Text
; 실제 실행되는 코드 등이 저장

; Endianness
; Byte Order, Byte를 배열하는 방법
; Big Endian, 큰 단위가 앞에
; Little Endian, 작은 단위가 앞에

; ----

; 문법 { Intel (주로 쓰임), AT&amp;T }
; 명령어 수행 방식 (ADD EAX EBX, Intel은 EAX += EBX, AT&amp;T는 EBX += EAX)
; 값/숫자 표기 방식 (Intel은 16진수 Prefix h와 2진수 Prefix b, AT&amp;T는 Prefix $)
; 레지스터 표기 방식 (Intel은 그대로, AT&amp;T는 Prefix %)

; 한 줄 주석  

COMMENT !
여러 줄 주석
느낌표 대신 @, #, $, % 등도 가능
!

COMMENT !

C 인라인 어셈블리
__asm
{
    ;
}

!

; 대소문자 상관 없음

; NOP, 0x90
; 아무 작업도 안함, 클럭 소모, 1Byte의 빈 공간 차지

; MOV A B
; MOVE, A에 B 값 넣기, 연산 포함 불가능

; 명령어와 조합하여 크기를 나타내는 접미사
; l Long 4-Byte
; w Word 2-Byte
; b Byte 1-Byte

; I.E. movl, 4-Byte 메모리를 옮긴다
; = 크기가 고정되어 있는 레지스터를, 각 크기별로 쪼개어 쓸 수 있다

; LEA A B
; Load Effective Address, 연산 포함 가능
; LEA EAX, [EAX + 1000]

; INC
; Increase 피 연산자에 1을 더하기
; 연산 결과에 따라 Zero Flag ZF, Overflow Flag OF 세트 가능

; JMP A
; 특정 위치 A로 점프
; JA, JB, JE 등
; ---
; 004013D4     EB 01
; 004013D6     CC
; ---
; 215:      jmp     label_1
; 216:      int     3
; 217:  label_1:
; ---
; jmp == 0xEB 0x01  
; 어셈블리에서 JMP는 한개지만 실제로 기계어코드로 바뀔때는 옆의 오퍼랜드(위에서는 0x01)에 따라 각각 다른 명령으로 대치된다.  
; 이 명령은 1바이트 건너뛰라는 뜻이 되겠다.

; CALL
; 함수를 호출했다가 다시 원래 위치로 돌아올 때
; JMP와 다른 점은 실행한 뒤에 끝나면 RET에 저장하고 다시 원래 상태로 돌아옴

! RET
; 현재 함수가 끝난 뒤에 돌아갈 주소를 지정하기 위해 사용

; PUSH
; 스택에 값 넣기

; POP
; 스택에 있는 값 빼내기

; INT 3, 0xCC
; 디버그 인터럽트

; LEAVE
; 현재까지의 메모리 스택 비우고, EBP를 자신이 호출한 메모리로 채움
; 실행중인 함수를 종료하기 위해 정리하는 작업에 사용

; 문법
; 함수 리턴 값은 RAX, EAX에 저장
; 목적지는 RDI, 출발지는 RSI
; RBP Base Pointer
; RSP Stack Pointer
; RIP 현재 실행할 코드의 주소

; 시스템 콜

; 레지스터 0 초기화

; MOV AX, 0
; (크기 3~4)

; SUB AX, AX
; XOR AX, AX
; (크기 1~2)

add eax, edx;
; eax와 edx의 내용을 더한다.

; 더한값은 eax 레지스터에 저장된다.

</code></pre><hr /><div class="language-c highlighter-rouge"><div class="code-header"> <span text-data=" C "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre>
<span class="c1">// Inline Assembly</span>

<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">if</span> <span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">else</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>

<span class="c1">//</span>

<span class="kt">int</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kr">__asm</span>
<span class="p">{</span>
    <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span><span class="n">dword</span> <span class="n">ptr</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
    <span class="n">cmp</span> <span class="n">eax</span><span class="p">,</span><span class="mi">0</span>
    <span class="n">jz</span> <span class="n">lb_set_a1</span>

<span class="nl">lb_set_a0:</span>
    <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span><span class="n">eax</span>
    <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">eax</span>

<span class="nl">lb_set_a1:</span>
    <span class="n">inc</span> <span class="n">eax</span>
    <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span><span class="p">[</span><span class="n">a</span><span class="p">],</span><span class="n">eax</span>
<span class="p">}</span>

<span class="c1">//</span>

<span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="n">lb_loop</span><span class="o">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">)</span>
    <span class="k">goto</span> <span class="n">lb_exit_loop</span><span class="p">;</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="n">i</span><span class="p">;</span>
    <span class="n">I</span><span class="o">++</span><span class="p">;</span>
    <span class="k">goto</span> <span class="n">lb_loop</span><span class="p">;</span>

<span class="n">lb_exit_loop</span><span class="o">:</span>

<span class="c1">//</span>

<span class="kt">int</span> <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="kr">__asm</span>
<span class="p">{</span>
    <span class="n">xor</span> <span class="n">ecx</span><span class="p">,</span><span class="n">ecx</span>
    <span class="n">xor</span> <span class="n">edx</span><span class="p">,</span><span class="n">edx</span>

<span class="nl">lb_loop:</span>
    <span class="n">inc</span> <span class="n">ecx</span>
    <span class="n">add</span> <span class="n">edx</span><span class="p">,</span><span class="n">ecx</span>

    <span class="n">cmp</span> <span class="n">ecx</span><span class="p">,</span><span class="mi">100</span>
    <span class="n">jnz</span> <span class="n">lb_loop</span>

    <span class="n">mov</span> <span class="n">dword</span> <span class="n">ptr</span><span class="p">[</span><span class="n">s</span><span class="p">],</span><span class="n">edx</span>
<span class="p">}</span>

</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%EF%B8%8Fmemo/'>⛏️Memo</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=⛏️ Assembly - 카모뜨린 아지트&url=https://mascari4615.github.io/posts/Assembly/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=⛏️ Assembly - 카모뜨린 아지트&u=https://mascari4615.github.io/posts/Assembly/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=⛏️ Assembly - 카모뜨린 아지트&url=https://mascari4615.github.io/posts/Assembly/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li> <a href="/posts/My-Dictionary/">⛏️ 메모</a><li> <a href="/posts/Unity-UI/">🌱 Unity UI 메모</a><li> <a href="/posts/DayStone-230521/">🌱 마작</a><li> <a href="/posts/DayStone-230518/">🌱 감기</a><li> <a href="/posts/DayStone-230515/">🌱 날계란</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/unity/">Unity</a> <a class="post-tag" href="/tags/vrc/">VRC</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/c/">C</a> <a class="post-tag" href="/tags/cpp/">CPP</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/OnParticleCollision-Not-Work/"><div class="card-body"> <span class="timeago small" >Jan 6<i class="unloaded">2023-01-06T23:46:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>🕯️ OnParticleCollision 이 호출되지 않을 때</h3><div class="text-muted small"><p> 💎 OnParticleCollision 이 호출되지 않을 때 파티클 시스템에서 Collision 이 켜져있는 지확인 Collision 에서 Type 이 World 인지 확인 (기본 Plane) ⭐ Collision 에서 Send Collision Messages 가 켜져있는지 확인 Collision 에서 Collision Qual...</p></div></div></a></div><div class="card"> <a href="/posts/Prefix-K-For-Constants/"><div class="card-body"> <span class="timeago small" >Jan 6<i class="unloaded">2023-01-06T23:46:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>🕯️ 상수 이름에 접두사 k, 헝가리안 표기법</h3><div class="text-muted small"><p> 💎 상수 이름에 접두사 k 참고 요약 : c는 char의 약자로 이미 쓰고 있기 때문에, 수학에서 상수로 쓰이고, 독일어로 상수의 첫 글자인 (konstant), k 를 쓰게 되었다. … 혹은 그저 정말 발음이 유사해서 썼다던지. private const int kVariable = 1; 위처럼 상수 이름 앞에 k를 붙이는 경우...</p></div></div></a></div><div class="card"> <a href="/posts/The-Swap-Trick/"><div class="card-body"> <span class="timeago small" >Jan 7<i class="unloaded">2023-01-07T23:22:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>🕯️ The Swap Trick</h3><div class="text-muted small"><p> 💎 The Swap Trick : 메모리 재할당 참고0 참고1 참고2 참고3 읽기 좋은 코드가 좋은 코드다의 84p 에서 언급된 The Swap Trick. 아래는 책에 나온 예제 코드다. struct Recorder { vector&lt;float&gt; data; ... void Clear() { ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CR-LF-CRLF/" class="btn btn-outline-primary" prompt="Older"><p>⛏️ CR, LF, CRLF</p></a> <a href="/posts/Economy/" class="btn btn-outline-primary" prompt="Newer"><p>⛏️ Economy</p></a></div><script src="https://utteranc.es/client.js" repo="Mascari4615/blog-comments" issue-term="pathname" theme="dark-blue" crossorigin="anonymous" async></script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href=""></a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/unity/">Unity</a> <a class="post-tag" href="/tags/vrc/">VRC</a> <a class="post-tag" href="/tags/programmers/">Programmers</a> <a class="post-tag" href="/tags/ps/">PS</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/c/">C</a> <a class="post-tag" href="/tags/cpp/">CPP</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://Mascari4615.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QRNK1L0YH7"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QRNK1L0YH7'); }); </script>
